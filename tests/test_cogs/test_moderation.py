import pytest
from nextcord.ext import commands
from cogs.moderation import moderation
from unittest.mock import AsyncMock, MagicMock

@pytest.fixture
def bot():
    bot = commands.Bot(command_prefix="!")
    return bot

@pytest.fixture
def cog(bot):
    cog = moderation(bot)
    bot.add_cog(cog)
    return cog

def test_clean_command(cog, bot):
    assert cog.clean.name == "clean"
    assert cog.clean.description == "Solves many problems."

@pytest.mark.asyncio
async def test_clean_functionality(cog):
    interaction = AsyncMock()
    interaction.user = MagicMock()
    interaction.user.name = "TestUser"
    interaction.user.id = 123456789
    interaction.response.send_message = AsyncMock()
    interaction.target = MagicMock()
    interaction.target.add_reaction = AsyncMock()

    await cog.clean(interaction, message=interaction.target)

    interaction.response.send_message.assert_called_once_with("<a:bdk:920426208498421840>")
    assert interaction.target.add_reaction.call_count == 20
    reactions = ['🙅', '🙆', '🙇', '🙋', '🙌', '🙍', '🙎', '🙏', '✂', '✈', '✉', '✊', '✋', '✌', '✏', '❄', '❤', '🚀', '🚃', '🚄', '🚅', '🚇', '🚉', '🚌', '🚏', '🚑', '🚒', '🚓', '🚕', '🚗', '🚙', '🚚', '🚢', '🚤', '🚥', '🚧', '🚨', '🚩', '🚪', '🚫', '🚬', '🚲', '🚶', '🚽', '🛀', '⌚', '⌛', '⏰', '⏳', '☁', '☎', '☔', '☕', '♨', '♻', '♿', '⚓', '⚡', '⚽', '⚾', '⛄', '⛅', '⛪', '⛲', '⛳', '⛵', '⛺', '⭐', '⛽', '🃏', '🌀', '🌁', '🌂', '🌃', '🌄', '🌅', '🌆', '🌇', '🌈', '🌉', '🌊', '🌋', '🌏', '🌙', '🌛', '🌟', '🌠', '🌰', '🌱', '🌴', '🌵', '🌷', '🌸', '🌹', '🌺', '🌻', '🌼', '🌽', '🌾', '🌿', '🍀', '🍁', '🍂', '🍃', '🍄', '🍅', '🍆', '🍇', '🍈', '🍉', '🍊', '🍌', '🍍', '🍎', '🍏', '🍑', '🍒', '🍓', '🍔', '🍕', '🍖', '🍗', '🍘', '🍙', '🍚', '🍛', '🍝', '🍞', '🍟', '🍠', '🍡', '🍢', '🍣', '🍤', '🍥', '🍦', '🍧', '🍨', '🍩', '🍪', '🍫', '🍬', '🍭', '🍮', '🍯', '🍰', '🍱', '🍲', '🍳', '🍴', '🍵', '🍶', '🍷', '🍸', '🍹', '🍺', '🍻', '🎀', '🎁', '🎂', '🎃', '🎄', '🎅', '🎆', '🎇', '🎈', '🎉', '🎊', '🎋', '🎌', '🎍', '🎎', '🎏', '🎐', '🎑', '🎒', '🎓', '🎠', '🎡', '🎢', '🎣', '🎤', '🎥', '🎦', '🎧', '🎨', '🎩', '🎪', '🎫', '🎬', '🎭', '🎮', '🎯', '🎰', '🎱', '🎲', '🎳', '🎴', '🎵', '🎶', '🎷', '🎸', '🎹', '🎺',  '🎽', '🎾', '🎿', '🏀', '🏁', '🏂', '🏃', '🏄', '🏆', '🏈', '🏊', '🏠', '🏡', '🏢', '🏣', '🏥', '🏦', '🏧', '🏨', '🏩', '🏪', '🏫', '🏬', '🏭', '🏮', '🏯', '🏰', '🐌', '🐍', '🐎', '🐑', '🐒', '🐔', '🐗', '🐘', '🐙', '🐚', '🐛', '🐜', '🐝', '🐞', '🐟', '🐠', '🐡', '🐢', '🐣', '🐤', '🐥', '🐦', '🐧', '🐨', '🐩', '🐫', '🐬', '🐭', '🐮', '🐯', '🐰', '🐱', '🐲', '🐳', '🐴', '🐵', '🐶', '🐷', '🐸', '🐹', '🐺', '🐻', '🐼', '🐽', '🐾', '👀', '👂', '👃', '👄', '👅', '👆', '👇', '👈', '👉', '👊', '👋', '👌', '👍', '👎', '👏', '👐', '👑', '👒', '👓', '👔', '👕', '👖', '👗', '👘', '👙', '👚', '👛', '👜', '👝', '👞', '👟', '👠', '👡', '👢', '👣',  '👦', '👧', '👨', '👩', '👪', '👫', '👮', '👯', '👰', '👱', '👴', '👶', '👷', '👸', '👹', '👺', '👻', '👼', '👽', '👾', '👿', '💀', '💁', '💂', '💃', '💄', '💅', '💆', '💇', '💈', '💉', '💊', '💋', '💌', '💍', '💎', '💏', '💐', '💑', '💒', '💓', '💔', '💕', '💖', '💗', '💘', '💙', '💚', '💛', '💜', '💝', '💞', '💟', '💠', '💡', '💢', '💣', '💤', '💥', '💦', '💧', '💨', '💩', '💪', '💫', '💬', '💮', '💯', '💰', '💲', '💳', '💵', '💸', '💺', '💻', '💼', '💽', '💾',  '📀', '📃', '📅', '📆', '📈', '📉', '📌', '📍', '📎', '📓', '📔', '📕', '📖', '📞', '📟', '📠', '📡', '📣', '📦', '📧', '📫', '📰', '📱', '📷', '📹', '📺', '📻', '📼', '🔊', '🔋', '🔌', '🔎', '🔐', '🔑', '🔒', '🔓', '🔔', '🔜', '🔥', '🔦', '🔧', '🔨', '🔩', '🔪', '🔫', '🔮', '🗻', '🗼', '🗽', '🗾', '🗿', '😴', '🚁', '🚂', '🚆', '🚈', '🚊', '🚍', '🚎', '🚐', '🚔', '🚖', '🚘', '🚛', '🚜', '🚝', '🚞', '🚟', '🚠', '🚡', '🚣', '🚦', '🚮', '🚵', '🚿', '🛁', '🌍', '🌎', '🌜', '🌝', '🌞', '🌲', '🌳', '🍋', '🍐', '🍼', '🏇', '🏉', '🏤', '🐀', '🐁', '🐂', '🐃', '🐄', '🐅', '🐆', '🐇', '🐈', '🐉', '🐊', '🐋', '🐏', '🐐', '🐓', '🐕', '🐖', '🐪', '👭', '📬', '📭', '📯', '🔬', '🔭']
    for i in range(20):
        assert interaction.target.add_reaction.call_args_list[i][0][0] in reactions
